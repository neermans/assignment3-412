<!-- templates/mini_fb/show_profile.html -->
<!-- A template to show a profile page for one user inheriting from base.html-->

{% extends 'mini_fb/base.html' %}

{% block content %}
<h2>{{ profile.first_name }} {{ profile.last_name }}'s Profile</h2>
<img src="{{ profile.profile_image_url }}" alt="Profile Image" width="200">
<p>City: {{ profile.city }}</p>

<!-- Section to show the friends of the specific profile you are on -->
<h3>Friends of {{ profile.first_name }} {{ profile.last_name }}</h3>
<ul>
    {% for friend in profile.get_friends %}
        <li>
            <a href="{% url 'show_profile' friend.pk %}">
                <img src="{{ friend.profile_image_url }}" alt="{{ friend.first_name }}'s Profile Image" width="50">
                {{ friend.first_name }} {{ friend.last_name }}
            </a>
        </li>
    {% empty %}
        <p>{{ profile.first_name }} has no friends yet.</p>
    {% endfor %}
</ul>

<h3>Status Messages</h3>
<ul>
    {% for status in status_messages %}
        <li>
            <strong>{{ status.timestamp }}</strong>: {{ status.message }}
            
            <!-- Only show update and delete options if the logged-in user is the profile owner -->
            {% if user == profile.user %}
                <a href="{% url 'update_status' status.pk %}">Update</a> |
                <a href="{% url 'delete_status' status.pk %}">Delete</a>
            {% endif %}
            
            <!-- Loop through images associated with this status message -->
            {% for img in status.images %}
                <div>
                    <img src="{{ img.image.url }}" alt="Image for {{ status.message }} message" width="200">
                </div>
            {% endfor %}
        </li>
    {% empty %}
        <p>No status messages available.</p>
    {% endfor %}
</ul>

<!-- Only show these links if the logged-in user is the profile owner -->
{% if user == profile.user %}
    <a href="{% url 'create_status' profile.pk %}">Post a Status Message</a>
    <br><br>
    <a href="{% url 'update_profile' profile.pk %}">Update Profile</a> 
    <br><br>
    <a href="{% url 'friend_suggestions' pk=profile.pk %}">View Friend Suggestions</a>
    <br><br>
    <a href="{% url 'news_feed' pk=profile.pk %}">View News Feed</a>
    <br><br>
{% endif %}

<a href="{% url 'show_all_profiles' %}">Back to All Profiles</a>
<br><br>
{% endblock %}
